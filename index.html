<!DOCTYPE html>
<html lang="en" data-theme="dark">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0" />
    <title>thegolfbuild</title>
    <meta name="description" content="Generate personalized golf practice plans, build custom routines, and track progress with thegolfbuild." />
    <link rel="canonical" href="https://thegolfbuild.com/" />
    <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
    <link rel="manifest" href="/manifest.webmanifest" />
    <meta name="theme-color" content="#070707" />
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Rajdhani:wght@500;600;700&family=Space+Grotesk:wght@400;500;600;700&display=swap"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="/styles.css" />
  </head>
  <body>
    <div class="bg-grid"></div>
    <div id="toastContainer" class="toast-container" aria-live="polite"></div>

    <div id="onboardingOverlay" class="onboarding-overlay hidden" hidden>
      <div class="onboarding-card">
        <button id="onboardingClose" class="onboarding-close" type="button" aria-label="Close onboarding">&times;</button>
        <div class="onboarding-steps">
          <div class="onboarding-step active" data-step="0">
            <div class="onboarding-icon">&#9971;</div>
            <h2>Welcome to thegolfbuild</h2>
            <p>Build personalized practice routines backed by a smart rules engine. Track your sessions, browse drills, and take your game to the range.</p>
          </div>
          <div class="onboarding-step" data-step="1">
            <div class="onboarding-icon">&#9881;</div>
            <h2>Set up your profile</h2>
            <p>Tell us your handicap, primary weakness, and schedule. The engine picks drills matched to your level and goals across a 4-week plan.</p>
          </div>
          <div class="onboarding-step" data-step="2">
            <div class="onboarding-icon">&#10004;</div>
            <h2>Track, export, improve</h2>
            <p>Check off sessions as you complete them. Export routines to PDF or calendar. Watch your stats grow on the performance dashboard.</p>
          </div>
        </div>
        <div class="onboarding-dots">
          <span class="onboarding-dot active" data-dot="0"></span>
          <span class="onboarding-dot" data-dot="1"></span>
          <span class="onboarding-dot" data-dot="2"></span>
        </div>
        <div class="onboarding-actions">
          <button id="onboardingSkip" class="btn btn-outline" type="button">Skip</button>
          <button id="onboardingNext" class="btn btn-primary" type="button">Next</button>
        </div>
      </div>
    </div>

    <header class="topbar">
      <div class="brand-wrap">
        <p class="brand-tag">Golf training intelligence</p>
        <h1>thegolfbuild</h1>
      </div>
      <div class="topbar-right">
        <button id="themeToggleBtn" class="btn btn-outline theme-toggle-btn" type="button" title="Toggle light/dark theme">
          <span id="themeIcon">&#9788;</span>
        </button>
        <button id="loadDemoBtn" class="btn btn-outline" type="button">Load Demo Data</button>
        <button id="topSignInBtn" class="btn btn-primary hidden" type="button">Sign In</button>
        <div id="userMenuWrap" class="user-menu-wrap hidden">
          <button id="userMenuBtn" class="btn btn-outline user-menu-btn" type="button" title="User menu">
            <span id="userAvatar" class="user-avatar">&#9679;</span>
            <span id="userMenuName" class="user-menu-name"></span>
          </button>
          <div id="userMenuDropdown" class="user-menu-dropdown hidden">
            <p id="welcomeMessage" class="user-menu-greeting"></p>
            <button id="changePasswordBtn" class="btn btn-outline user-menu-item" type="button">Change Password</button>
            <div id="changePasswordPanel" class="reset-panel hidden">
              <label>
                Current Password
                <div class="password-field-wrap">
                  <input type="password" id="currentPasswordInput" placeholder="Your current password" />
                  <button type="button" class="password-toggle" data-target="currentPasswordInput" title="Show password">&#9673;</button>
                </div>
              </label>
              <label>
                New Password
                <div class="password-field-wrap">
                  <input type="password" id="newPasswordInput" placeholder="At least 8 characters" />
                  <button type="button" class="password-toggle" data-target="newPasswordInput" title="Show password">&#9673;</button>
                </div>
              </label>
              <div class="cta-row">
                <button id="submitPasswordChangeBtn" class="btn btn-primary" type="button">Update Password</button>
                <button id="cancelPasswordChangeBtn" class="btn btn-outline" type="button">Cancel</button>
              </div>
            </div>
            <button id="topLogoutBtn" class="btn btn-danger user-menu-item" type="button">Logout</button>
          </div>
        </div>
      </div>
    </header>

    <nav class="tab-bar">
      <button id="showHomeBtn" class="tab-btn active" type="button">
        <span class="tab-icon">&#9750;</span><span class="tab-label">Home</span>
      </button>
      <button id="showGeneratedRoutineBtn" class="tab-btn" type="button">
        <span class="tab-icon">&#9776;</span><span class="tab-label">Routine</span>
      </button>
      <button id="showDrillLibraryBtn" class="tab-btn" type="button">
        <span class="tab-icon">&#9863;</span><span class="tab-label">Drills</span>
      </button>
      <button id="showStatsBtn" class="tab-btn" type="button">
        <span class="tab-icon">&#9670;</span><span class="tab-label">Stats</span>
      </button>
      <button id="showAdminBtn" class="tab-btn hidden" type="button">
        <span class="tab-icon">&#9881;</span><span class="tab-label">Admin</span>
      </button>
    </nav>

    <main class="layout">
      <section id="homePanel" class="panel home-panel hidden">
        <!-- Onboarding view (new/incomplete users) -->
        <div id="homeOnboarding" class="home-onboarding hidden">
          <div class="home-hero">
            <h2>Build your best practice plan</h2>
            <p class="plan-mode-note">Set your profile once, then follow a plan that adapts based on what you complete each week.</p>
          </div>
          <div class="home-checklist">
            <h3>Getting Started</h3>
            <div id="homeChecklistSteps"></div>
          </div>
        </div>

        <!-- Full dashboard (returning users) -->
        <div id="homeDashboard" class="home-dashboard hidden">
          <div id="homeTodayCard" class="home-today-card"></div>
          <div id="homeProfileBar" class="home-profile-bar"></div>
          <details id="homeSetupSection" class="home-setup-section hidden">
            <summary>Setup</summary>
            <div id="homeSetupChecklistSteps" class="home-setup-checklist"></div>
          </details>
          <div id="homeProgressGrid" class="home-progress-grid"></div>
          <div id="homeQuickActions" class="home-quick-actions"></div>
          <div id="homeRecentRoutines" class="home-recent-routines"></div>
        </div>

        <!-- Inline session runner (takes over home panel) -->
        <div id="homeSessionRunner" class="home-session-runner hidden">
          <div class="runner-back-row">
            <button id="runnerBackBtn" class="btn btn-ghost" type="button">&#8592; Back</button>
          </div>
          <div id="runnerHeader" class="runner-header"></div>
          <div id="runnerDrills" class="runner-drills"></div>
          <div class="runner-footer">
            <div class="runner-progress-wrap">
              <div class="runner-progress-label">
                <span id="runnerProgressText">0 / 0 drills</span>
                <span id="runnerProgressPct">0%</span>
              </div>
              <div class="saved-progress-wrap runner-bar-wrap">
                <div id="runnerProgressBar" class="saved-progress-bar" style="width:0%"></div>
              </div>
            </div>
            <button id="runnerCompleteBtn" class="btn btn-brand runner-complete-btn" type="button" disabled>
              Complete Session
            </button>
          </div>
        </div>
      </section>

      <section id="authPanel" class="panel auth-panel">
        <div class="auth-head">
          <h2>Account</h2>
          <p id="authStatus" class="auth-status">Not signed in</p>
        </div>

        <form id="authForm" class="form-stack auth-grid">
          <label id="registerNameField" class="hidden">
            Name
            <input type="text" id="accountName" placeholder="Jordan Lee" />
          </label>
          <label>
            Email
            <input type="email" id="accountEmail" placeholder="you@example.com" required />
          </label>
          <label>
            Password
            <div class="password-field-wrap">
              <input type="password" id="accountPassword" placeholder="At least 8 characters" required />
              <button type="button" class="password-toggle" data-target="accountPassword" title="Show password">&#9673;</button>
            </div>
          </label>
          <div class="cta-row">
            <button id="registerBtn" class="btn btn-primary hidden" type="button">Create Account</button>
            <button id="loginBtn" class="btn btn-primary" type="button">Login</button>
            <button id="showRegisterBtn" class="btn btn-outline" type="button">Register</button>
            <button id="showLoginBtn" class="btn btn-outline hidden" type="button">Back to Login</button>
            <button id="logoutBtn" class="btn btn-danger hidden" type="button">Logout</button>
          </div>
        </form>
        <p id="appMessage" class="app-message" aria-live="polite"></p>
      </section>

      <section class="panel plan-panel">
        <h2 id="planPanelTitle" class="sr-only">Practice Routine</h2>

        <!-- Plan tab segmented control (kept for compatibility, hidden in library-first UI) -->
        <div class="segmented-control plan-seg hidden" id="planSegControl" role="tablist">
          <button class="seg-btn active" id="planSegGenerated" type="button" role="tab" aria-selected="true">Generated</button>
          <button class="seg-btn" id="planSegCustom" type="button" role="tab" aria-selected="false">Custom</button>
        </div>

        <div id="routineLibraryActions" class="routine-library-top-actions">
          <button id="openGenerateFlowBtn" class="btn btn-primary" type="button">Generate New Routine</button>
          <button id="openCustomFlowBtn" class="btn btn-outline" type="button">Create Custom Routine</button>
        </div>
        <div id="routineCreateFlowHeader" class="routine-create-flow-head hidden">
          <button id="closeRoutineCreateFlowBtn" class="btn btn-outline btn-sm" type="button">&#8592; Back to My Routines</button>
        </div>

        <!-- Generated mode wrapper -->
        <div id="planGeneratedView">

        <div id="profileSummary" class="profile-summary hidden">
          <div class="profile-summary-tags">
            <span class="profile-tag" id="summaryName"></span>
            <span class="profile-tag" id="summaryHandicap"></span>
            <span class="profile-tag" id="summaryWeakness"></span>
            <span class="profile-tag" id="summarySchedule"></span>
          </div>
          <div class="profile-summary-actions">
            <button id="editProfileBtn" class="btn btn-outline btn-sm" type="button">Edit</button>
            <button id="summaryGenerateBtn" class="btn btn-primary btn-sm" type="button">Generate Routine</button>
          </div>
        </div>

        <div id="profileFormWrap" class="profile-form-wrap">
          <form id="profileForm" class="form-stack">
            <label>
              Name
              <input type="text" id="name" placeholder="Jordan Lee" required />
            </label>

            <div class="form-field">
              <span class="form-label">Handicap Level</span>
              <div class="btn-group" id="handicapGroup">
                <button type="button" class="btn-toggle" data-value="Beginner (20+)">Beginner (20+)</button>
                <button type="button" class="btn-toggle" data-value="Intermediate (10-19)">Intermediate (10-19)</button>
                <button type="button" class="btn-toggle" data-value="Advanced (0-9)">Advanced (0-9)</button>
              </div>
              <input type="hidden" id="handicap" required />
            </div>

            <div class="form-field">
              <span class="form-label">Weaknesses (pick up to 2)</span>
              <div class="chip-grid" id="weaknessGrid">
                <button type="button" class="chip" data-value="Driving accuracy">Driving accuracy</button>
                <button type="button" class="chip" data-value="Approach consistency">Approach consistency</button>
                <button type="button" class="chip" data-value="Ball striking">Ball striking</button>
                <button type="button" class="chip" data-value="Short game touch">Short game touch</button>
                <button type="button" class="chip" data-value="Chipping & pitching">Chipping &amp; pitching</button>
                <button type="button" class="chip" data-value="Putting confidence">Putting confidence</button>
                <button type="button" class="chip" data-value="Lag putting">Lag putting</button>
                <button type="button" class="chip" data-value="Distance control">Distance control</button>
                <button type="button" class="chip" data-value="Course management">Course management</button>
                <button type="button" class="chip" data-value="Mental game">Mental game</button>
                <button type="button" class="chip" data-value="Fairway woods & hybrids">Fairway woods &amp; hybrids</button>
                <button type="button" class="chip" data-value="Scoring under pressure">Scoring under pressure</button>
              </div>
              <input type="hidden" id="weakness" required />
            </div>

            <div class="form-field">
              <span class="form-label">Days / week</span>
              <div class="btn-group" id="daysPerWeekGroup">
                <button type="button" class="btn-toggle" data-value="1">1</button>
                <button type="button" class="btn-toggle" data-value="2">2</button>
                <button type="button" class="btn-toggle selected" data-value="3">3</button>
                <button type="button" class="btn-toggle" data-value="4">4</button>
                <button type="button" class="btn-toggle" data-value="5">5</button>
                <button type="button" class="btn-toggle" data-value="6">6</button>
                <button type="button" class="btn-toggle" data-value="7">7</button>
              </div>
              <input type="hidden" id="daysPerWeek" value="3" required />
            </div>

            <div class="form-field">
              <span class="form-label">Session duration</span>
              <div class="duration-picker" id="durationPicker">
                <div class="duration-scroll-group">
                  <label class="duration-scroll-label">Hours</label>
                  <div class="duration-scroll-wrap">
                    <button type="button" class="duration-arrow up" data-target="durationHours" data-dir="up">&#9650;</button>
                    <div class="duration-scroll-value" id="durationHours" data-value="1">1</div>
                    <button type="button" class="duration-arrow down" data-target="durationHours" data-dir="down">&#9660;</button>
                  </div>
                </div>
                <span class="duration-separator">:</span>
                <div class="duration-scroll-group">
                  <label class="duration-scroll-label">Min</label>
                  <div class="duration-scroll-wrap">
                    <button type="button" class="duration-arrow up" data-target="durationMinutes" data-dir="up">&#9650;</button>
                    <div class="duration-scroll-value" id="durationMinutes" data-value="30">30</div>
                    <button type="button" class="duration-arrow down" data-target="durationMinutes" data-dir="down">&#9660;</button>
                  </div>
                </div>
              </div>
              <input type="hidden" id="hoursPerSession" value="1.5" required />
            </div>

            <label>
              Notes or Constraints
              <textarea id="notes" rows="3" placeholder="Example: only have access to range on weekdays"></textarea>
            </label>

            <div class="cta-row">
              <button id="generateRoutineBtn" class="btn btn-primary" type="submit">Generate Routine</button>
              <button id="clearProfileBtn" class="btn btn-outline" type="button">Clear</button>
            </div>
          </form>
        </div>
        <div id="generatedRoutineView">
          <div id="routineEmptyState" class="empty-state">
            <span id="routineEmptyText">Complete your profile above to generate a training routine.</span>
          </div>
          <article id="routineCard" class="routine-card hidden">
            <div class="routine-header">
              <div class="routine-header-info">
                <input id="routineTitle" class="routine-title" type="text" placeholder="Routine name" />
                <p id="routineMeta" class="routine-meta"></p>
              </div>
            </div>
            <div class="routine-actions">
              <button id="changeRoutineBtn" class="btn btn-outline" type="button">Change Routine</button>
              <button id="saveRoutineBtn" class="btn btn-primary" type="button">Save to Profile</button>
              <div class="export-menu-wrap">
                <button id="exportMenuBtn" class="btn btn-outline" type="button">Export &#9662;</button>
                <div id="exportMenuDropdown" class="export-menu-dropdown hidden">
                  <button id="exportPdfBtn" class="btn btn-outline" type="button">Export PDF</button>
                  <button id="exportIcalBtn" class="btn btn-outline" type="button">Export iCal</button>
                </div>
              </div>
            </div>
            <div id="routineWeeks" class="routine-weeks"></div>
          </article>
        </div>
        </div><!-- /planGeneratedView -->

        <div id="customRoutineView" class="hidden">
          <div class="panel-subsection custom-subsection">
            <h3>Custom Routine Builder</h3>
            <p class="plan-mode-note">Build your own routine with drills from the library or custom tasks.</p>
          </div>

          <!-- Step 1: Setup -->
          <div id="customStep1" class="custom-step">
            <form id="customSetupForm" class="form-stack">
              <label>
                Routine Title
                <input type="text" id="customTitle" placeholder="My 3-Week Short Game Sprint" required />
              </label>
              <div class="inline-fields">
                <label>
                  Weeks
                  <input type="number" id="customWeeks" min="1" max="12" value="3" required />
                </label>
                <label>
                  Sessions / week
                  <input type="number" id="customSessions" min="1" max="7" value="3" required />
                </label>
              </div>
              <button class="btn btn-primary" type="submit">Next: Build Sessions</button>
            </form>
          </div>

          <!-- Step 2: Session Builder -->
          <div id="customStep2" class="custom-step hidden">
            <div class="custom-session-tabs" id="customSessionTabs"></div>

            <div id="customSessionEditor" class="custom-session-editor">
              <h4 id="customSessionTitle">Session 1</h4>

              <div class="custom-drill-picker">
                <input type="text" id="customDrillSearch" placeholder="Search drills to add..." />
                <div class="custom-picker-filters">
                  <button class="filter-chip custom-filter" data-filter-value="warmup" type="button">Warmup</button>
                  <button class="filter-chip custom-filter" data-filter-value="technical" type="button">Technical</button>
                  <button class="filter-chip custom-filter" data-filter-value="pressure" type="button">Pressure</button>
                  <button class="filter-chip custom-filter" data-filter-value="transfer" type="button">Transfer</button>
                </div>
                <div id="customDrillResults" class="custom-drill-results hidden"></div>
              </div>

              <div class="custom-manual-add">
                <div class="inline-fields">
                  <label class="custom-manual-label-wide">
                    Custom task
                    <input type="text" id="customTaskInput" placeholder="e.g. Bunker exits from wet sand" />
                  </label>
                  <label class="custom-manual-label-narrow">
                    Min
                    <input type="number" id="customTaskDuration" min="1" max="120" value="15" />
                  </label>
                </div>
                <button id="customAddTaskBtn" class="btn btn-outline btn-sm" type="button">+ Add Custom Task</button>
              </div>

              <div id="customSessionItems" class="custom-session-items">
                <p class="custom-empty-hint">No items yet. Search drills above or add a custom task.</p>
              </div>

              <div class="cta-row">
                <button id="customBackToSetupBtn" class="btn btn-outline" type="button">Back</button>
                <button id="customToPreviewBtn" class="btn btn-primary" type="button">Preview Routine</button>
              </div>
            </div>
          </div>

          <!-- Step 3: Preview -->
          <div id="customStep3" class="custom-step hidden">
            <div id="customPreviewContent"></div>
            <div class="cta-row">
              <button id="customBackToEditorBtn" class="btn btn-outline" type="button">Back to Editor</button>
              <button id="customCreateBtn" class="btn btn-primary" type="button">Create Routine</button>
            </div>
          </div>
        </div>
      </section>

      <section id="drillLibraryPanel" class="panel drill-library-panel hidden">
        <h2>Drill Library</h2>
        <p class="plan-mode-note">Browse all 330 drills grouped by weakness category. Click any drill to expand its description.</p>
        <div class="drill-search-bar">
          <input type="text" id="drillSearchInput" placeholder="Search drills..." />
          <p id="drillResultCount" class="drill-result-count"></p>
          <button id="selectedDrillsBtn" class="btn btn-outline drill-selected-chip" type="button" disabled>Selected (0)</button>
        </div>
        <div class="drill-filter-row">
          <div class="drill-filter-group">
            <span class="drill-filter-label">Type:</span>
            <button class="filter-chip" data-filter-type="type" data-filter-value="warmup" type="button">Warmup</button>
            <button class="filter-chip" data-filter-type="type" data-filter-value="technical" type="button">Technical</button>
            <button class="filter-chip" data-filter-type="type" data-filter-value="pressure" type="button">Pressure</button>
            <button class="filter-chip" data-filter-type="type" data-filter-value="transfer" type="button">Transfer</button>
          </div>
          <div class="drill-filter-group">
            <span class="drill-filter-label">Level:</span>
            <button class="filter-chip" data-filter-type="level" data-filter-value="beginner" type="button">Beginner</button>
            <button class="filter-chip" data-filter-type="level" data-filter-value="intermediate" type="button">Intermediate</button>
            <button class="filter-chip" data-filter-type="level" data-filter-value="advanced" type="button">Advanced</button>
          </div>
        </div>
        <div id="drillLibraryContent" class="drill-library-content"></div>
      </section>

      <section id="statsPanel" class="panel stats-panel hidden">
        <h2>Performance Dashboard</h2>
        <div id="statsContent" class="stats-content">
          <div class="stats-grid">
            <div class="stat-card">
              <p class="stat-value" id="statRoutines">-</p>
              <p class="stat-label">Routines Saved</p>
            </div>
            <div class="stat-card">
              <p class="stat-value" id="statCompleted">-</p>
              <p class="stat-label">Sessions Completed</p>
            </div>
            <div class="stat-card">
              <p class="stat-value" id="statStreak">-</p>
              <p class="stat-label">Current Streak</p>
            </div>
            <div class="stat-card">
              <p class="stat-value" id="statLongest">-</p>
              <p class="stat-label">Longest Streak</p>
            </div>
          </div>
          <div class="stats-detail">
            <h3>Session Progress</h3>
            <div class="progress-bar-wrap">
              <div id="statProgressBar" class="progress-bar" style="width:0%"></div>
            </div>
            <p id="statProgressText" class="stat-progress-text">0 / 0 sessions</p>
          </div>
          <div class="stats-detail">
            <h3>Weakness Coverage</h3>
            <div id="statWeakness" class="weakness-chart"></div>
          </div>
        </div>
      </section>

      <section id="adminPanel" class="panel stats-panel hidden">
        <h2>Admin</h2>
        <p class="plan-mode-note">Registered users</p>
        <div class="usage-row">
          <p id="adminUserCount" class="usage-text">-</p>
          <button id="adminRefreshBtn" class="btn btn-outline btn-sm" type="button">Refresh</button>
        </div>
        <div class="admin-table-wrap">
          <table class="admin-table" id="adminUsersTable">
            <thead>
              <tr>
                <th>Name</th>
                <th>Email</th>
                <th>Plan</th>
                <th>Role</th>
                <th>Routines</th>
              </tr>
            </thead>
            <tbody id="adminUsersBody">
              <tr><td colspan="5" class="admin-empty">No users loaded.</td></tr>
            </tbody>
          </table>
        </div>
      </section>

    </main>

    <!-- Drill Detail Modal -->
    <div id="drillModal" class="modal-overlay hidden" role="dialog" aria-modal="true" hidden>
      <div class="modal-card">
        <button id="drillModalClose" class="modal-close" type="button">&times;</button>
        <h3 id="drillModalName"></h3>
        <div id="drillModalBadges" class="modal-badges"></div>
        <p id="drillModalDesc" class="modal-desc"></p>
        <div id="drillModalActions" class="cta-row"></div>
        <div id="drillModalSwap" class="modal-swap hidden">
          <h4>Swap with</h4>
          <div id="drillModalAlternatives" class="modal-alternatives"></div>
        </div>
      </div>
    </div>

    <!-- Session Reflection Modal -->
    <div id="reflectionModal" class="modal-overlay hidden" role="dialog" aria-modal="true" hidden>
      <div class="modal-card">
        <button id="reflectionModalClose" class="modal-close" type="button">&times;</button>
        <h3>Session Reflection</h3>
        <p class="modal-desc">How did this session go?</p>
        <div class="reflection-stars" id="reflectionStars">
          <span class="star" data-val="1">&#9733;</span>
          <span class="star" data-val="2">&#9733;</span>
          <span class="star" data-val="3">&#9733;</span>
          <span class="star" data-val="4">&#9733;</span>
          <span class="star" data-val="5">&#9733;</span>
        </div>
        <input type="text" id="reflectionNote" placeholder="Quick note (optional)" maxlength="120" />
        <div class="reflection-tags" id="reflectionTags">
          <button type="button" class="tag-btn" data-tag="Helpful">Helpful</button>
          <button type="button" class="tag-btn" data-tag="Too Easy">Too Easy</button>
          <button type="button" class="tag-btn" data-tag="Too Hard">Too Hard</button>
          <button type="button" class="tag-btn" data-tag="Great Drills">Great Drills</button>
        </div>
        <div class="cta-row" style="margin-top:0.8rem">
          <button id="reflectionSaveBtn" class="btn btn-primary" type="button">Save Reflection</button>
          <button id="reflectionSkipBtn" class="btn btn-outline" type="button">Skip</button>
        </div>
      </div>
    </div>

    <!-- Confirm Modal -->
    <div id="confirmModal" class="modal-overlay hidden" role="dialog" aria-modal="true" hidden>
      <div class="modal-card">
        <button id="confirmModalClose" class="modal-close" type="button">&times;</button>
        <h3 id="confirmModalTitle">Are you sure?</h3>
        <p id="confirmModalMessage" class="modal-desc"></p>
        <div class="cta-row" style="margin-top:0.8rem">
          <button id="confirmModalOk" class="btn btn-danger" type="button">Confirm</button>
          <button id="confirmModalCancel" class="btn btn-outline" type="button">Cancel</button>
        </div>
      </div>
    </div>

    <!-- Auth Gate Modal -->
    <div id="authGateModal" class="modal-overlay hidden" role="dialog" aria-modal="true" hidden>
      <div class="modal-card auth-gate-card">
        <button id="authGateClose" class="modal-close" type="button">&times;</button>
        <h3 id="authGateTitle">Sign in to continue</h3>
        <form id="authGateForm" class="form-stack">
          <label id="authGateNameField" class="hidden">
            Name
            <input type="text" id="authGateName" placeholder="Jordan Lee" />
          </label>
          <label>
            Email
            <input type="email" id="authGateEmail" placeholder="you@example.com" required />
          </label>
          <label>
            Password
            <div class="password-field-wrap">
              <input type="password" id="authGatePassword" placeholder="At least 8 characters" required />
              <button type="button" class="password-toggle" data-target="authGatePassword" title="Show password">&#9673;</button>
            </div>
          </label>
          <p id="authGateMessage" class="app-message" aria-live="polite"></p>
          <div class="cta-row">
            <button id="authGateSubmitBtn" class="btn btn-primary" type="submit">Login</button>
            <button id="authGateToggleBtn" class="btn btn-outline" type="button">Register</button>
          </div>
        </form>
      </div>
    </div>

    <!-- Routine Switcher Modal -->
    <div id="routineSwitcherModal" class="modal-overlay hidden" role="dialog" aria-modal="true" hidden>
      <div class="modal-card switcher-card">
        <button id="switcherModalClose" class="modal-close" type="button">&times;</button>
        <h3>My Routines</h3>
        <div class="usage-row">
          <p id="usageText" class="usage-text"></p>
          <button id="upgradeBtn" class="btn btn-primary btn-sm" type="button">Upgrade to Pro</button>
        </div>
        <div id="switcherEmptyState" class="empty-state hidden">No routines saved yet.</div>
        <div id="switcherList" class="switcher-list"></div>
      </div>
    </div>

    <script src="selected-drills-store.js" defer></script>
    <script src="/app.js" defer></script>
    <script>
      if ("serviceWorker" in navigator) {
        navigator.serviceWorker.register("/sw.js").catch(() => {});
      }
    </script>
  </body>
</html>
